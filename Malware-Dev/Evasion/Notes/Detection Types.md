# Learning Malware Development - Evasion Techniques

As I progress in my malware development journey, understanding how AV and EDR systems detect code is the first step toward building stealthy tools. Modern security solutions use a layered defense. Here is my breakdown of the four main detection types.

---

## 1.1 Detection Methodologies

### 1.1.1 Signature Based Detection
This is the most basic level. It is like a digital fingerprint check.

* **Definition:** Identifying threats based on known patterns like binary strings or file hashes.
* **Simple Example:** If I compile a standard Meterpreter payload, its SHA256 hash is already in the AV database. The moment the file touches the disk, it is deleted.
* **Weakness:** It only knows what it has seen before.
* **My Evasion Plan:** I will use polymorphism or basic XOR encryption on my shellcode so the hash is different every time I compile.

### 1.1.2 Heuristic Detection
This looks for "red flags" in the file structure or code characteristics.

* **Definition:** Rule based checks that look for suspicious attributes without needing an exact signature match.
* **Simple Example:** An EXE that has no icons, no version information, and uses the VirtualAllocEx API might be flagged as suspicious because that is common behavior for loaders.
* **Weakness:** It often flags legitimate administrative tools by mistake.
* **My Evasion Plan:** I will add legitimate metadata (icons, file descriptions) and avoid using common "malicious" API names directly by using dynamic loading.

### 1.1.3 Behavioral Detection
This is about what the program does, not what it is. It watches the code while it runs.

* **Definition:** Real time monitoring of system calls, memory changes, and process creation.
* **Simple Example:** If my program starts and immediately tries to inject code into Notepad.exe and then connects to a random IP address, the EDR will kill the process.
* **Weakness:** It is resource heavy for the computer, so it cannot monitor every single action forever.
* **My Evasion Plan:** I can use execution delays (Sleep) or PPID Spoofing to make my process look like it was started by a trusted Windows process like explorer.exe.

### 1.1.4 Machine Learning Based Detection
The "smart" layer that uses models to predict if a file is dangerous.

* **Definition:** Models trained on millions of files to identify malware like patterns.
* **Simple Example:** An ML model might notice that my file has an unusually high "entropy" (randomness), which usually means the code is encrypted or packed, and flag it as a 90 percent match for malware.
* **Weakness:** These models can be "confused" if you mix in enough "good" code.
* **My Evasion Plan:** I will include "junk code" or strings from legitimate Windows system files to make my binary look more like a normal application.

---

## Detection Summary Table

| Detection Type | Method | Strength | Weakness |
| :--- | :--- | :--- | :--- |
| Signature Based | Pattern Matching | Very fast for known files | Fails against new code |
| Heuristic | Rule Based | Catches common "shady" traits | High false positive rate |
| Behavioral | Runtime Monitoring | Catches zero day actions | Can be fooled by timing |
| Machine Learning | Prediction Models | Adaptive to new threats | Can be fooled by noise |

---

## Credits
This information was summarized from my studies with **Red Team Leaders**.

---